<!-- Gallery grid -->
<div class="gallery"></div>

<!-- Expanding image container -->
<div class="gallery-popup-background">
    <div class="gallery-expanded-image">
        <!-- Close the image -->
        <span onclick="this.parentElement.parentElement.style.display='none'; $(caption).css('display', 'none');" class="closebtn">&times;</span>
    
        <!-- Expanded image -->
        <img id="expandedImg">

        <!-- Open the caption -->
        <span onclick="expandCaption(this);" class="captionbtn"><img src="assets/ui/caption-icon.png" alt="info"/></span>

        <div class="text" id="caption">
            <!-- Image header -->
            <h3 id="imgHeader"></h3>
        
            <!-- Image description -->
            <p id="imgDescription"></p>
        </div>
        
    </div>
</div>

<!-- UI functions -->
<script>
function expandImage(img) {
    var expandedImg = document.getElementById("expandedImg");
    var imgHeader = document.getElementById("imgHeader");
    var imgText = document.getElementById("imgDescription");

    expandedImg.src = $(img).attr("src");
    imgHeader.innerText = $(img).attr("header");
    imgText.innerText = $(img).attr("description");

    expandedImg.parentElement.parentElement.style.display = "block";
}

function expandCaption(button) {
    var caption = $(button).next();

    if(caption.css('display') == 'none') {
        caption.css('display', 'block');
        $('#imgHeader').fitText(1, { minFontSize: '10px', maxFontSize: '20px'});
        $('#imgDescription').fitText(2.5, { minFontSize: '10px', maxFontSize: '20px'});
    }
    else {
        caption.css('display', 'none');
    }
}
</script>

<!-- <script type="module">
    import { parse } from '/assets/js/csv-main/index.js'
</script> -->

<!-- Data functions -->
<script>
function displayImages() {
    var dir = "/images/";
    $.get('imagedata.csv', function(CSVdata) {
        var data = $.csv.toObjects(CSVdata);
        console.log(data);
        var i = 0;
        var currRow = null;
        data.forEach(element => {
            if(i % 4 == 0) {
                currRow = $("<div class='gallery-row'></div>");
                $('.gallery').append(currRow);
            }
            currRow.append("<div class='gallery-column'><img src='" + dir + element['filename'] + "' alt='" + element['alt'] + "' onclick='expandImage(this);' style='cursor: pointer;' id='image' header='" + element['header'] + "' description='" + element['description'] + "'/></div>");
            ++i;
        });
    });
}

displayImages();
</script>
